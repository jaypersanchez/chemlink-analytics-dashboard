<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChemLink Analytics Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ChemLink Analytics Dashboard</h1>
            <p class="subtitle">Real-time platform metrics and insights</p>
        </header>

        <!-- Summary Cards -->
        <section class="summary-section">
            <h2>Quick Stats (Last 30 Days)</h2>
            <div class="cards-grid" id="summaryCards">
                <div class="card loading">Loading...</div>
            </div>
        </section>

        <!-- Growth Metrics -->
        <section class="metrics-section category-growth">
            <div class="category-header">
                <h2>ğŸ“ˆ Growth Metrics</h2>
                <p class="category-description">Track user acquisition and platform expansion</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="new-users-monthly">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>New Users - Monthly Trend</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know if our marketing efforts are working or how fast we're acquiring users compared to competitors</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ˆ New Users - Monthly Trend</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>This chart displays the total number of new users who signed up each month. Each bar represents one month's worth of new registrations.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Higher bars = more new sign-ups that month. Look for upward trends to see if your user acquisition is growing.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without this data, you can't tell if marketing campaigns are effective or how you compare to competitors in growth speed.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>SELECT COUNT(*) FROM persons GROUP BY month</code></p>
                    </div>
                    <canvas id="newUsersMonthlyChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="growth-rate">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>User Growth Rate - Monthly</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We can't measure if our growth is accelerating, stagnating, or declining month-over-month for investor/board reporting</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ˆ User Growth Rate - Monthly</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>This shows the percentage change in new users compared to the previous month. It reveals if your growth is accelerating or slowing down.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Positive % = growth, Negative % = decline. A line trending upward means growth is accelerating!</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Investors and board members need to see if momentum is building or fading. This metric is crucial for fundraising and strategic planning.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Calculate % change: (current - previous) / previous * 100</code></p>
                    </div>
                    <canvas id="growthRateChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container" data-tooltip="dau">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Daily Active Users (DAU) - Last 30 Days</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We have no visibility into daily engagement patterns or which days/features drive the most activity</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ˆ Daily Active Users (DAU)</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>The number of unique users who posted or commented each day over the last 30 days. This measures actual platform engagement, not just sign-ups.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Look for patterns: Are weekdays busier? Are there spikes after feature launches or marketing campaigns?</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without daily metrics, you can't identify which days/times are most active or detect problems like sudden drop-offs in engagement.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>COUNT DISTINCT users from posts + comments per day</code></p>
                    </div>
                    <canvas id="dauChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="mau">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Monthly Active Users (MAU)</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We can't tell if users are actually using our platform regularly or just signing up and abandoning it</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ˆ Monthly Active Users (MAU)</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Monthly count of unique users who actually used the platform (posted or commented), not just signed up.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>This is your "stickiness" metric. Higher MAU means more users returning regularly. Compare to total sign-ups to see retention rate.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Sign-ups don't equal success. MAU reveals if users find value and keep coming back, or if they register and abandon the platform.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>COUNT DISTINCT users with posts OR comments per month</code></p>
                    </div>
                    <canvas id="mauChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="mau-country">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>MAU by Country</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We can't tell if users are actually using our platform regularly or just signing up and abandoning it</span>
                    </div>
                    <div class="pain-point" style="background: linear-gradient(135deg, #ffe9a6 0%, #ffd966 100%); border-left-color: #ff9800;">
                        <span class="pain-icon">âš ï¸</span>
                        <span class="pain-text"><strong>Database Limitation:</strong> Location data is in ChemLink DB but engagement data (posts/comments) is in Engagement DB with separate person IDs. Currently showing "Unknown" for all users until databases are synced.</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸŒ MAU by Country</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Breakdown of Monthly Active Users by their country. Shows geographic distribution of your engaged user base.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Identify which countries have the strongest user engagement. This helps target marketing and localization efforts.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without geographic data, you can't prioritize which markets to invest in or identify untapped opportunities.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Cross-database join: Engagement DB (activity) + ChemLink DB (locations)</code></p>
                        <h4>ğŸš« Current Limitation</h4>
                        <p>Person IDs don't match between databases. Requires data sync or unified ID system.</p>
                    </div>
                    <canvas id="mauByCountryChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container" data-tooltip="dau-comprehensive">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>DAU - Comprehensive (All Activity Types)</h3>
                    <button class="sql-button" onclick="showSQLModal('dau_comprehensive')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Track ALL user activities: profile views, searches, votes, collections, and profile updates</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“Š DAU - Comprehensive</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Daily active users tracking ALL platform activities: profile views, votes, collection creation, and profile updates. More comprehensive than post/comment activity alone.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Each point represents unique users who performed ANY action on the platform that day. Higher = more engagement across all features.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Standard DAU only tracks posts/comments, missing users who view profiles, search, or curate collections. This gives the full engagement picture.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>view_access + query_votes + collections + persons.updated_at</code></p>
                    </div>
                    <canvas id="dauComprehensiveChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="mau-comprehensive">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>MAU - Comprehensive (All Activity Types)</h3>
                    <button class="sql-button" onclick="showSQLModal('mau_comprehensive')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Complete picture of monthly engagement across all platform features</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ˆ MAU - Comprehensive</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Monthly active users across ALL features: profile browsing, voting, collections, and profile maintenance. Shows true platform stickiness beyond content creation.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Upward trend = growing engaged user base. Compare to new user signups to calculate activation rate (MAU / Total Users).</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Many users are "lurkers" who view and curate but don't post. This metric captures them and shows platform value beyond content creators.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>All activities from ChemLink DB aggregated monthly</code></p>
                    </div>
                    <canvas id="mauComprehensiveChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width hidden-chart" data-tooltip="login-velocity">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Login Velocity (Past 24 Hours)</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't have real-time visibility into authentication spikes or drop-offs to catch outages early</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ” Login Velocity (Hourly)</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Number of sessions Kratos issued each hour over the last 24 hours. Each point represents successful logins in that hour.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Look for sudden dips (potential outages) or spikes (campaigns, brute-force attempts). Flat lines may mean no one is signing in.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Support and ops teams can't see authentication health without digging into logs. This exposes issues before customers file tickets.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>sessions table from chemonics-kratos-prd (grouped hourly)</code></p>
                    </div>
                    <canvas id="loginVelocityChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width hidden-chart" data-tooltip="unique-identities">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Authenticated Users (Unique Identities - 30 Days)</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Compare real sign-ins vs in-app DAU to spot drift between identity and engagement systems</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ§ Unique Authenticated Identities</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Daily count of distinct Kratos identities that successfully signed in. Highlights the true number of people passing authentication each day.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Trend this line against DAU to ensure every authenticated user shows up in product usage. Divergence can signal tracking gaps or sign-in issues.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without visibility into identity-level traffic, outages or mismatched IDs between systems go unnoticed until users complain.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Kratos sessions table (distinct identity_id per day)</code></p>
                    </div>
                    <canvas id="uniqueIdentitiesChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="user-type">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Active Users by Type (Standard vs Finder)</h3>
                    <button class="sql-button" onclick="showSQLModal('user_type')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Understand adoption and engagement of Finder (AI-powered) vs Standard users</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ¯ Active Users by Type</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Segmentation of active users by whether they have Finder (AI-powered search) enabled vs Standard users. Shows adoption of premium AI features.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Two bars per month: Finder Users (blue) vs Standard Users (orange). Growing Finder segment = successful AI feature adoption and conversion.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Finder is our competitive advantage. Low Finder adoption means users aren't discovering or valuing our AI capabilities. Need to improve onboarding or feature visibility.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Activity joined with persons.has_finder field</code></p>
                    </div>
                    <canvas id="activeUsersByTypeChart"></canvas>
                </div>
            </div>
        </section>

        <!-- User Engagement -->
        <section class="metrics-section category-engagement">
            <div class="category-header">
                <h2>ğŸ‘¥ User Engagement & Social Activity</h2>
                <p class="category-description">Measure community interactions and content performance</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="post-frequency">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Post Frequency - Daily (Last 30 Days)</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We can't tell if our platform is gaining momentum or if community activity is declining over time</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ Post Frequency - Daily</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Number of posts created each day and how many unique users posted. Tracks content creation momentum.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Upward trend = growing activity. Flat or declining = engagement problem. Check if marketing campaigns or features cause spikes.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Can't tell if your platform is gaining traction or losing steam. Essential for detecting early warning signs of declining engagement.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>COUNT posts per day + COUNT DISTINCT posters</code></p>
                    </div>
                    <canvas id="postFrequencyChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="engagement-rate">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Post Engagement Rate by Type</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know if our community features are creating meaningful interactions or just noise</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ’¬ Post Engagement Rate by Type</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>How many comments each post type gets on average. Shows which content drives the most discussion.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Higher engagement rate = content resonates with users. Use this to guide content strategy and feature development.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without engagement data, you're building features blindly. This shows what actually creates value and community interaction.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Comments per post by content type</code></p>
                    </div>
                    <canvas id="engagementRateChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container" data-tooltip="content-type">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Content Type Distribution</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know if our community features are creating meaningful interactions or just noise</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“Š Content Type Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Breakdown of what types of content users are posting (text, images, links, etc.). Shows content preferences.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Large slices = popular content types. Compare to engagement rates to see if popular = engaging.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Helps understand if users are using all features or just a subset. Critical for feature investment decisions.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>COUNT posts GROUP BY type</code></p>
                    </div>
                    <canvas id="contentTypeChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="active-posters">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Top 10 Active Posters</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We need to identify and nurture our most valuable community contributors for platform growth</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ† Top 10 Active Posters</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Your top contributors ranked by engagement score (posts + comments weighted). These are your community champions.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Power Users (purple) are critical to platform health. Nurture them with recognition, early features, or partnership opportunities.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>10% of users drive 90% of content. Identify and retain these power users or risk losing your entire community.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Engagement score = posts*3 + comments*2</code></p>
                    </div>
                    <canvas id="activePostersChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Activity Type Analytics -->
        <section class="metrics-section category-activity">
            <div class="category-header">
                <h2>ğŸ“Š Activity Type Analytics</h2>
                <p class="category-description">Understand what actions users are taking and their engagement intensity</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="activity-by-type-monthly">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Monthly Active Users by Activity Type</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">See which activities users perform - posting vs commenting trends</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“Š MAU by Activity Type</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Monthly breakdown of unique users by activity type (posts vs comments). Stacked bars show composition of engagement.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Stacked bars show how many users posted vs commented each month. Growing comment stack = improving engagement depth.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Understand if users are just broadcasting (posting) or actually engaging (commenting). Comments = stronger community bonds.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>posts + comments from Engagement DB</code></p>
                    </div>
                    <canvas id="activityByTypeMonthlyChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="activity-distribution">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Activity Distribution - Current Month</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">What percentage of users post vs comment this month?</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ¥§ Activity Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Pie chart showing percentage breakdown of users by activity type for the current month.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Slice sizes show activity mix. 100% posting = one-way broadcast. Balanced = healthy discussions.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Dominated by posting = echo chamber. Need commenting to create network effects and retention.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Current month posts + comments</code></p>
                    </div>
                    <canvas id="activityDistributionChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="activity-intensity">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>User Engagement Intensity Levels</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">How many power users vs casual users do we have each month?</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ”¥ Engagement Intensity</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Users categorized by activity level: Power Users (20+), Active (10-19), Regular (5-9), Casual (1-4) activities per month.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Stacked bars show user distribution across intensity tiers. Growing Power User segment = platform maturity.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Power users drive 80% of platform value. Track growth of this segment to measure engagement quality, not just quantity.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>User activity counts categorized by thresholds</code></p>
                    </div>
                    <canvas id="activityIntensityLevelsChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Feature Adoption & Funnels -->
        <section class="metrics-section category-funnel">
            <div class="category-header">
                <h2>ğŸ”„ Feature Adoption & Funnels</h2>
                <p class="category-description">Track user onboarding and feature adoption drop-offs</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="account-funnel">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Account Creation Drop-off Funnel (Bar)</h3>
                    <button class="sql-button" onclick="showSQLModal('account_funnel')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know where users are dropping off during onboarding - critical for improving activation rates</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ”„ Account Creation Funnel</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>User drop-off at each stage of account creation. Shows where users abandon the onboarding process.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Wider bars = more users at that stage. Biggest narrowing = critical drop-off point needing attention.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Can't improve activation rates without knowing where users drop off. Each lost user is lost revenue.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>persons table with profile completion indicators</code></p>
                    </div>
                    <canvas id="accountFunnelChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="account-funnel-pyramid">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Account Creation Funnel (Pyramid)</h3>
                    <button class="sql-button" onclick="showSQLModal('account_funnel')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Visual representation of user drop-off - wider = more users, narrower = fewer users</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ”„ Funnel Pyramid View</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Same data as bar chart but in classic funnel/pyramid shape. Width represents user volume at each stage.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Top (widest) = most users. Bottom (narrowest) = fewest users. Each level shows percentage retained.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Classic funnel visualization makes drop-off patterns immediately obvious to stakeholders.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>persons table with profile completion indicators</code></p>
                    </div>
                    <canvas id="accountFunnelPyramidChart"></canvas>
                </div>
            </div>

            <!-- Finder Search Analytics -->
            <div class="chart-row">
                <div class="chart-container" data-tooltip="finder-searches">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Finder Search Volume</h3>
                    <button class="sql-button" onclick="showSQLModal('finder_searches')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Don't know if users are actually using our AI-powered Finder feature</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ” Finder Search Volume</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Total searches performed using the Finder AI feature over time. Shows feature adoption.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Upward trend = users finding value in AI search. Flat = feature not being discovered.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Finder is a key differentiator. Low usage means we're not converting users to our AI-powered features.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>query_embeddings table</code></p>
                    </div>
                    <canvas id="finderSearchesChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="finder-intents">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Search Intent Distribution</h3>
                    <button class="sql-button" onclick="showSQLModal('finder_searches')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Need to understand what users are searching for to improve AI matching</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ¯ Search Intent Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Breakdown of search types/intents. Shows what users are looking for.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Top intents = user needs. Use this to prioritize AI model training and feature development.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without intent data, we can't optimize search quality or understand user needs.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>query_embeddings.intent field</code></p>
                    </div>
                    <canvas id="finderIntentsChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="finder-engagement">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Finder Engagement Rate</h3>
                    <button class="sql-button" onclick="showSQLModal('finder_engagement')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Don't know if our AI search results are actually useful to users</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ’¯ Finder Engagement Rate</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Percentage of searches that get votes/feedback. Shows search result quality.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High engagement = users finding relevant results. Low = AI needs improvement.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Poor search results mean users won't adopt Finder, losing our competitive advantage.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>query_votes / query_embeddings ratio</code></p>
                    </div>
                    <canvas id="finderEngagementChart"></canvas>
                </div>
            </div>

            <!-- Collections Feature Engagement -->
            <div class="chart-row">
                <div class="chart-container" data-tooltip="profile-additions">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Profile Additions to Collections</h3>
                    <button class="sql-button" onclick="showSQLModal('profile_additions')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know if users are actually utilizing our talent curation features</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“Š Profile Additions to Collections</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Monthly trend of how many profiles are being added to collections. Shows talent curation activity.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Upward trend = users finding value in organizing talent. Flat/declining = feature not sticky.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Collections are a key engagement feature. Low usage means users aren't seeing value in talent organization.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>collection_profiles table</code></p>
                    </div>
                    <canvas id="profileAdditionsChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="collections-created">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Collections Created</h3>
                    <button class="sql-button" onclick="showSQLModal('collections_created')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Need to understand if collections feature is being adopted</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ Collections Created</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Total collections and breakdown by privacy type. Shows feature adoption and usage patterns.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High private = users curating for themselves. High public = users sharing knowledge with community.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Collections feature adoption indicates platform maturity and advanced usage patterns.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>collections table</code></p>
                    </div>
                    <canvas id="collectionsCreatedChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="collections-shared">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Shared Collections</h3>
                    <button class="sql-button" onclick="showSQLModal('collections_shared')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Don't know if users are collaborating and sharing talent insights</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ¤ Shared Collections</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Collections that have been shared with collaborators. Shows collaboration activity.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High sharing = team collaboration happening. Low = users working in silos.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Collaboration features drive retention. Teams that work together stay together.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>collection_collaborators table</code></p>
                    </div>
                    <canvas id="collectionsSharedChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="collections-privacy">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Collections Created by Privacy (Public vs Private)</h3>
                    <button class="sql-button" onclick="showSQLModal('collections_privacy')">ğŸ’¾ SQL</button>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Understand whether users create private collections (personal) or public (community sharing)</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ”’ Collections by Privacy</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Stacked bar chart showing collections created each month, segmented by privacy level: Public (shareable) vs Private (personal curation).</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Green = Public collections (community knowledge sharing). Blue = Private collections (personal use). High private = users curating for themselves. High public = building community.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Collection privacy patterns reveal user intent. All private = users see value but aren't sharing. Balanced = healthy community + personal use. Drive public sharing to build network effects.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>collections.privacy field (PUBLIC/PRIVATE)</code></p>
                    </div>
                    <canvas id="collectionsPrivacyChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Profile Metrics -->
        <section class="metrics-section category-profile">
            <div class="category-header">
                <h2>ğŸ‘¤ Profile Quality Metrics</h2>
                <p class="category-description">Monitor user profile completeness and data freshness</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="profile-completion">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Profile Completion Score Distribution</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Incomplete profiles hurt our AI matching accuracy and reduce platform value for users</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">âœ… Profile Completion Score Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>How complete users' profiles are (0-7 scale: headline, LinkedIn, location, company, experience, education, languages). Higher = better quality.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Most users at 7 = great! Many at 0-2 = onboarding problem. Target campaigns to nudge incomplete profiles.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Incomplete profiles break AI matching and make the platform less valuable. Users get frustrated with poor match quality.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Sum of 7 profile completeness indicators</code></p>
                    </div>
                    <canvas id="profileCompletionChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="profile-status">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Profile Status Breakdown</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Incomplete profiles hurt our AI matching accuracy and reduce platform value for users</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“Š Profile Status Breakdown</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>User segments: FINDER_ENABLED (AI-powered), BUILDER_ONLY (basic profile), BASIC_PROFILE (minimal data). Shows feature adoption.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>FINDER_ENABLED = premium users with full AI features. Goal is to move users up this ladder through onboarding and engagement.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Users stuck at BASIC_PROFILE don't get full platform value and may churn. This shows how many users need profile improvement campaigns.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Categorize by embedding count and experience/education data</code></p>
                    </div>
                    <canvas id="profileStatusChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="profile-freshness">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Profile Update Freshness</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Stale profiles mean bad matches and frustrated users. Your database value decays over time without updates.</span>
                    </div>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ”„ Profile Update Freshness</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>How long ago users last updated their profiles. FRESH (<3mo), AGING (3-6mo), STALE (6+ mo). Shows data currency.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High STALE count = problem. Users change jobs, learn skills, but profiles don't reflect it. Send update reminders to stale profiles.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Stale profiles mean bad matches, frustrated users, and wasted recruiter time. Your database value decays over time without updates.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>Days since last profile update: CURRENT_DATE - updated_at</code></p>
                    </div>
                    <canvas id="profileFreshnessChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Talent Marketplace Intelligence -->
        <section class="metrics-section category-talent">
            <div class="category-header">
                <h2>ğŸ¯ Talent Marketplace Intelligence</h2>
                <p class="category-description">Understand who's on your platform and what they offer</p>
            </div>
            
            <div class="chart-row">
                <div class="chart-container" data-tooltip="top-companies">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Top Companies</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We don't know if we're attracting talent from premium companies or if our network quality is sufficient</span>
                    </div>
                    <button class="sql-button" onclick="showSQLModal('top_companies')">ğŸ’¾ SQL</button>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ¢ Top Companies</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Companies where your users currently work or have worked. Shows if you're attracting talent from recognized employers.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Top-tier companies (Google, Amazon, etc.) = premium network. Unknown companies = need better talent acquisition strategy.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Without knowing company distribution, you can't prove network quality or identify partnership opportunities.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>companies JOIN persons/experiences</code></p>
                    </div>
                    <canvas id="topCompaniesChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="top-roles">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Top Roles/Job Titles</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Without knowing what roles our users have, we can't build features that match their needs</span>
                    </div>
                    <button class="sql-button" onclick="showSQLModal('top_roles')">ğŸ’¾ SQL</button>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ’¼ Top Roles/Job Titles</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Most common job titles/roles on your platform. Shows skill distribution and experience levels.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Senior roles = experienced network. Junior roles = emerging talent. Use this to position platform messaging.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Building features blindly without knowing user roles leads to wasted dev time and poor product-market fit.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>roles JOIN experiences</code></p>
                    </div>
                    <canvas id="topRolesChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container" data-tooltip="education-distribution">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Education Distribution</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Understanding education credentials and top schools helps prove our talent pool is high-quality</span>
                    </div>
                    <button class="sql-button" onclick="showSQLModal('education_distribution')">ğŸ’¾ SQL</button>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ“ Education Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Degree types (BS, MS, PhD, etc.) on your platform. Indicates education level and expertise depth.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High PhD count = research-heavy network. Mostly Bachelor's = early-career focus. Use for recruiting positioning.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>This shows you have verified, educated talent in your network.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>degrees JOIN education</code></p>
                    </div>
                    <canvas id="educationDistributionChart"></canvas>
                </div>
                <div class="chart-container" data-tooltip="geographic-distribution">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Geographic Distribution</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">We're spending marketing budget blindly without knowing where our users are concentrated or which markets to prioritize</span>
                    </div>
                    <button class="sql-button" onclick="showSQLModal('geographic_distribution')">ğŸ’¾ SQL</button>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸŒ Geographic Distribution</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Where your users are located (by country). Shows market penetration and expansion opportunities.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>High concentration = strong market to double down on. Low concentration = untapped opportunity or need localization.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Spending equal marketing budget across all regions wastes money. Focus on where users already are.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>persons JOIN locations</code></p>
                    </div>
                    <canvas id="geographicDistributionChart"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <div class="chart-container full-width" data-tooltip="top-skills-projects">
                    <div class="info-icon">â„¹ï¸</div>
                    <h3>Top Skills & Projects</h3>
                    <div class="pain-point">
                        <span class="pain-icon">ğŸ’¡</span>
                        <span class="pain-text">Don't know what kind of work our users do or if they're doing cutting-edge projects</span>
                    </div>
                    <button class="sql-button" onclick="showSQLModal('top_skills_projects')">ğŸ’¾ SQL</button>
                    <div class="chart-tooltip">
                        <h3 class="tooltip-title">ğŸ› ï¸ Top Skills & Projects</h3>
                        <h4>ğŸ“Š What This Chart Shows</h4>
                        <p>Most common project types and skills listed by users. Shows what work your network does.</p>
                        <h4>ğŸ” How to Read It</h4>
                        <p>Cutting-edge projects (AI, ML, etc.) = premium talent. Generic projects = commodity skills. Use for employer pitch.</p>
                        <h4>âš ï¸ Business Pain Point</h4>
                        <p>Understanding what valuable, relevant work your network does helps inform platform strategy.</p>
                        <h4>ğŸ’¾ Data Source</h4>
                        <p><code>projects table</code></p>
                    </div>
                    <canvas id="topSkillsProjectsChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Top Posts Table -->
        <section class="metrics-section category-engagement">
            <h2>ğŸ† Top Performing Posts (Last 30 Days)</h2>
            <div class="pain-point">
                <span class="pain-icon">ğŸ’¡</span>
                <span class="pain-text">We don't know if valuable content is actually being seen by our community or getting buried</span>
            </div>
            <div class="table-container">
                <table id="topPostsTable">
                    <thead>
                        <tr>
                            <th>Post Preview</th>
                            <th>Author</th>
                            <th>Type</th>
                            <th>Comments</th>
                            <th>Unique Commenters</th>
                            <th>Days Old</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td colspan="6" class="loading">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <footer>
            <p>&copy; 2025 ChemLink Analytics Dashboard | Data refreshed in real-time</p>
        </footer>
    </div>

    <!-- SQL Query Modal -->
    <div id="sqlModal" class="sql-modal">
        <div class="sql-modal-content">
            <div class="sql-modal-header">
                <h2 id="sqlModalTitle">SQL Query</h2>
                <span class="sql-modal-close" onclick="closeSQLModal()">&times;</span>
            </div>
            <div class="sql-modal-body">
                <div class="sql-database" id="sqlDatabase"></div>
                <pre><code id="sqlQueryCode" class="language-sql"></code></pre>
            </div>
            <div class="sql-modal-footer">
                <button class="copy-sql-btn" onclick="copySQLToClipboard()">ğŸ“‹ Copy to Clipboard</button>
                <button class="close-btn" onclick="closeSQLModal()">Close</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sql-modal.js') }}"></script>
</body>
</html>
